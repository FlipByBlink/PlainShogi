import SwiftUI

struct SharePlayã‚¬ã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼: View {
    @EnvironmentObject var ãƒ¢ãƒ‡ãƒ«: ã‚¢ãƒ—ãƒªãƒ¢ãƒ‡ãƒ«
    private var SharePlayä¸­: Bool {
        [.waiting, .joined].contains(ãƒ¢ãƒ‡ãƒ«.ã‚°ãƒ«ãƒ¼ãƒ—ã‚»ãƒƒã‚·ãƒ§ãƒ³?.state)
    }
    var body: some View {
        List {
            if !self.SharePlayä¸­ {
                self.äº‹å‰æº–å‚™å®Œã‚»ã‚¯ã‚·ãƒ§ãƒ³()
                self.ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£å‚åŠ èª˜å°ã‚»ã‚¯ã‚·ãƒ§ãƒ³()
                self.ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£èµ·å‹•èª˜å°ã‚»ã‚¯ã‚·ãƒ§ãƒ³()
            }
            self.ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³()
            self.é›¢è„±ãƒœã‚¿ãƒ³ã‚„çµ‚äº†ãƒœã‚¿ãƒ³()
            Section { SharePlayç´¹ä»‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒªãƒ³ã‚¯() }
        }
        .animation(.default, value: self.SharePlayä¸­)
        .navigationTitle("å°†æ£‹ç›¤ã‚’SharePlay")
    }
    private func äº‹å‰æº–å‚™å®Œã‚»ã‚¯ã‚·ãƒ§ãƒ³() -> some View {
        Section {
            Text("ç¾åœ¨ã€å‹é”ã¨ç¹‹ãŒã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚å‹é”ãŒç«‹ã¡ä¸Šã’ãŸã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã«å‚åŠ ã™ã‚‹ã‹ã€ã‚‚ã—ãã¯è‡ªåˆ†ã§ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’èµ·å‹•ã—ã¾ã—ã‚‡ã†ã€‚")
                .padding(8)
        } header: {
            Text("äº‹å‰æº–å‚™å®Œäº†")
        }
    }
    private func ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£å‚åŠ èª˜å°ã‚»ã‚¯ã‚·ãƒ§ãƒ³() -> some View {
        Section {
            Text("å‹é”ãŒæ—¢ã«ã€Œå°†æ£‹ç›¤ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’èµ·å‹•ã—ã¦ã„ã‚‹å ´åˆã¯ã€ã‚·ã‚¹ãƒ†ãƒ å´ã®UIã‚’æ“ä½œã—ã¦ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã«å‚åŠ ã—ã¾ã—ã‚‡ã†ã€‚")
                .padding(8)
            Image("joinFromBanner")
                .resizable()
                .scaledToFit()
                .border(.black)
                .frame(maxWidth: .infinity, maxHeight: 180)
        } header: {
            Text("SharePlayã«å‚åŠ ã™ã‚‹")
                .textCase(.none)
        }
    }
    private func ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£èµ·å‹•èª˜å°ã‚»ã‚¯ã‚·ãƒ§ãƒ³() -> some View {
        Section {
            Text("è‡ªåˆ†ã‹ã‚‰SharePlayã‚’é–‹å§‹ã™ã‚‹äº‹ã‚‚ã§ãã¾ã™ã€‚ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’èµ·å‹•ã—ãŸã‚‰å‹é”ã«SharePlayå‚åŠ ã‚’ä¿ƒã—ã¾ã—ã‚‡ã†ã€‚")
                .padding(8)
            Button {
                ğŸ„¶roupActivity.ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’èµ·å‹•ã™ã‚‹()
                ãƒ¢ãƒ‡ãƒ«.è¡¨ç¤ºä¸­ã®ã‚·ãƒ¼ãƒˆ = nil
            } label: {
                Label("ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã€Œå°†æ£‹ç›¤ã€ã‚’èµ·å‹•ã™ã‚‹", systemImage: "power")
                    .font(.body.weight(.medium))
                    .padding(.vertical, 4)
            }
            .disabled(ãƒ¢ãƒ‡ãƒ«.ã‚°ãƒ«ãƒ¼ãƒ—ã‚»ãƒƒã‚·ãƒ§ãƒ³ != nil)
        } header: {
            Text("è‡ªåˆ†ã‹ã‚‰SharePlayã‚’é–‹å§‹ã™ã‚‹")
                .textCase(.none)
        }
    }
    @State private var çµ‚äº†ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º: Bool = false
    private func é›¢è„±ãƒœã‚¿ãƒ³ã‚„çµ‚äº†ãƒœã‚¿ãƒ³() -> some View {
        Group {
            if self.SharePlayä¸­ {
                Section {
                    Button {
                        ãƒ¢ãƒ‡ãƒ«.ã‚°ãƒ«ãƒ¼ãƒ—ã‚»ãƒƒã‚·ãƒ§ãƒ³?.leave()
                        ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚£ãƒ¼ãƒˆã‚™ãƒã‚™ãƒƒã‚¯.è­¦å‘Š()
                        ãƒ¢ãƒ‡ãƒ«.è¡¨ç¤ºä¸­ã®ã‚·ãƒ¼ãƒˆ = nil
                    } label: {
                        Label("ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‹ã‚‰é›¢è„±ã™ã‚‹", systemImage: "escape")
                    }
                } footer: {
                    Text("ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‹ã‚‰é›¢è„±ã—ã¦ã‚‚ã€è‡ªåˆ†ä»¥å¤–ã¯ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã«å‚åŠ ã—ãŸã¾ã¾ã§ã™ã€‚")
                }
                Section {
                    Button {
                        self.çµ‚äº†ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º = true
                        ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚£ãƒ¼ãƒˆã‚™ãƒã‚™ãƒƒã‚¯.è»½ã‚()
                    } label: {
                        Label("ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’çµ‚äº†ã™ã‚‹", systemImage: "power.dotted")
                    }
                } footer: {
                    Text("ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’çµ‚äº†ã™ã‚‹ã¨ã€å…¨å“¡ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‹ã‚‰é›¢è„±ã—ã¾ã™ã€‚")
                }
                .confirmationDialog("ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’çµ‚äº†ã—ã¾ã™ã‹ï¼Ÿ",
                                    isPresented: self.$çµ‚äº†ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º,
                                    titleVisibility: .visible) {
                    Button(role: .destructive) {
                        ãƒ¢ãƒ‡ãƒ«.ã‚°ãƒ«ãƒ¼ãƒ—ã‚»ãƒƒã‚·ãƒ§ãƒ³?.end()
                        ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚£ãƒ¼ãƒˆã‚™ãƒã‚™ãƒƒã‚¯.ã‚¨ãƒ©ãƒ¼()
                        ãƒ¢ãƒ‡ãƒ«.è¡¨ç¤ºä¸­ã®ã‚·ãƒ¼ãƒˆ = nil
                    } label: {
                        Label("ã¯ã„ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’çµ‚äº†ã—ã¾ã™", systemImage: "power.dotted")
                    }
                } message: {
                    Text("ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’çµ‚äº†ã™ã‚‹ã¨ã€å…¨å“¡ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‹ã‚‰é›¢è„±ã—ã¾ã™ã€‚")
                }
            }
        }
    }
    private func ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³() -> some View {
        Group {
            if ãƒ¢ãƒ‡ãƒ«.ã‚°ãƒ«ãƒ¼ãƒ—ã‚»ãƒƒã‚·ãƒ§ãƒ³ != nil {
                Section {
                    Label("ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£", systemImage: "power")
                        .badge(ãƒ¢ãƒ‡ãƒ«.ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒ¼ãƒˆè¡¨è¨˜)
                    Label("ç¾åœ¨ã®å‚åŠ è€…æ•°", systemImage: "person.3")
                        .badge(ãƒ¢ãƒ‡ãƒ«.å‚åŠ äººæ•°?.description)
                } header: {
                    Text("çŠ¶æ³")
                }
            }
        }
    }
}
